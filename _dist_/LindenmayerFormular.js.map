{
  "version": 3,
  "sources": ["/home/runner/work/Three.LS/Three.LS/src/LindenmayerFormular.ts"],
  "sourcesContent": ["import Turtle from './Turtle';\nimport { Rule } from './Rule';\nimport { LSystem } from './LSystem';\nimport Utils from './Utils';\nimport { OBJExporter } from 'three/examples/jsm/exporters/OBJExporter.js';\nimport { scene, generateAndRepaintLindenmayerMesh } from './indexNormal';\n\nexport class LindenmayerFormular {\n    private static instance: LindenmayerFormular;\n\n    private btnAdd: HTMLInputElement;\n    private btnRemove: HTMLInputElement;\n    private btnUpload: HTMLInputElement;\n    private btnDownload: HTMLInputElement;\n    private objDownloadButton: HTMLInputElement;\n    private fileUpload: HTMLInputElement;\n    private makeSmallButton: HTMLInputElement;\n\n    private rulesWrapper: HTMLDivElement;\n\n    private countAllRules: number;\n\n    private constructor() {\n        this.btnAdd = document.querySelector('#btnAddRule');\n        this.btnRemove = document.querySelector('#btnRemoveRule');\n        this.btnUpload = document.querySelector('#btnUpload');\n        this.btnDownload = document.querySelector('#btnDownload');\n        this.rulesWrapper = document.querySelector('#rulesWrapper');\n        this.objDownloadButton = document.querySelector('#btnDownloadOBJ');\n        this.fileUpload = document.querySelector('#jsonUpload');\n        this.makeSmallButton = document.querySelector('#makesmall');\n\n        this.countAllRules = 1;\n\n        this.addListenerToAddButton();\n        this.addListenerToRemoveButton();\n        this.addListenerToDownloadButton();\n        this.addListenerToUploadButton();\n        this.addListenerToOBJDownloadButton();\n        this.makeSmall();\n    }\n\n    public static getInstance(): LindenmayerFormular {\n        if (LindenmayerFormular.instance == undefined) LindenmayerFormular.instance = new LindenmayerFormular();\n        return LindenmayerFormular.instance;\n    }\n\n    private addListenerToAddButton(): void {\n        this.btnAdd.addEventListener('click', () => {\n            this.addNewRuleField();\n        });\n    }\n\n    private addNewRuleField(): void {\n        this.rulesWrapper.insertAdjacentHTML(\n            'beforeend',\n            ' <div class=\"interface__rule-wrapper\" style=\"margin-top: 1rem;\" id=\"count' +\n                (this.countAllRules + 1) +\n                '\"> <div class=\"interface__input-inner-wrapper\"> <label>A' +\n                (this.countAllRules + 1) +\n                '</label> <input class=\"interface__input-field axioms\" type=\"text\" id=\"axiom' +\n                (this.countAllRules + 1) +\n                '\" maxlength=\"1\" placeholder=\"F\" required> </div> <div class=\"interface__input-inner-wrapper\"> <label>R' +\n                (this.countAllRules + 1) +\n                '</label> <input class=\"interface__input-field rules\" type=\"text\" id=\"rule' +\n                (this.countAllRules + 1) +\n                '\" placeholder=\"FF+[+F-F-F]-[-F+F+F]\" required> </div> </div>',\n        );\n        this.countAllRules++;\n        if (this.btnRemove.disabled == true) this.btnRemove.disabled = false;\n    }\n\n    private addListenerToRemoveButton(): void {\n        this.btnRemove.addEventListener('click', () => {\n            this.removeRuleField();\n        });\n    }\n\n    private removeRuleField(): void {\n        const allRulesLength = this.rulesWrapper.children.length;\n\n        if (allRulesLength > 1) {\n            document.querySelector('#count' + this.countAllRules).remove();\n            this.countAllRules--;\n        }\n\n        if (this.countAllRules <= 1) this.btnRemove.disabled = true;\n    }\n\n    private addListenerToDownloadButton(): void {\n        this.btnDownload.addEventListener('click', () => {\n            const baseAxiom = (document.getElementById('sentence') as HTMLInputElement).value;\n            const ruleString = [];\n            const axiomString = [];\n            //test\n            for (let j = 1; j <= this.countAllRules; j++) {\n                const value: string = j.toString();\n                ruleString[j - 1] = (document.getElementById('rule' + value) as HTMLInputElement).value;\n                axiomString[j - 1] = (document.getElementById('axiom' + value) as HTMLInputElement).value;\n            }\n\n            const iterationsCount = (document.getElementById('countIterations') as HTMLInputElement).value;\n            //\n            const turningAngle = (document.getElementById('degrees') as HTMLInputElement).value;\n            const stepLength = (document.getElementById('steplength') as HTMLInputElement).value;\n\n            const newObject = {\n                baseAxiom: baseAxiom,\n                replaceFrom: axiomString,\n                replaceTo: ruleString,\n                iterationsCount: iterationsCount,\n                turningAngle: turningAngle,\n                stepLength: stepLength,\n            };\n            const json_string = JSON.stringify(newObject, undefined, 2);\n            const link = document.createElement('a');\n            link.download = 'data.json';\n            const blob = new Blob([json_string], { type: 'text/plain' });\n            link.href = window.URL.createObjectURL(blob);\n            link.click();\n        });\n    }\n\n    private addListenerToUploadButton(): void {\n        this.btnUpload.addEventListener('click', () => {\n            const reader = new FileReader();\n            /*eslint-disable */\n            reader.onload = (_event: ProgressEvent) => {\n                /*eslint-enable */\n                const obj: any = JSON.parse(reader.result.toString());\n                let moreRulesExist = true;\n                //Liest X Rule und Axiom Werte ab\n                for (let j = 1; moreRulesExist == true; j++) {\n                    const value: string = j.toString();\n                    if (obj.replaceTo[j - 1] == null) {\n                        moreRulesExist = false;\n                        this.removeRuleField();\n                    } else {\n                        (<HTMLInputElement>document.getElementById('rule' + value)).value = obj.replaceTo[j - 1];\n                        (<HTMLInputElement>document.getElementById('axiom' + value)).value = obj.replaceFrom[j - 1];\n                        this.addNewRuleField();\n                    }\n                }\n                (<HTMLInputElement>document.getElementById('countIterations')).value = obj.iterationsCount;\n                (<HTMLInputElement>document.getElementById('degrees')).value = obj.turningAngle;\n                (<HTMLInputElement>document.getElementById('steplength')).value = obj.stepLength;\n                (<HTMLInputElement>document.getElementById('sentence')).value = obj.baseAxiom;\n\n                generateAndRepaintLindenmayerMesh();\n            };\n            //Reduzierung von rule Feldern\n            const staticRuleCounter = this.countAllRules;\n            for (let i = 1; i <= staticRuleCounter; i++) {\n                this.removeRuleField();\n            }\n\n            if (!this.fileUpload.files[0]) alert('Bitte Datei ausw\u00E4hlen');\n            else reader.readAsText(this.fileUpload.files[0]);\n        });\n    }\n\n    public generateLSystemImage(): Turtle {\n        const axioms: string[] = [];\n        const rules: string[] = [];\n\n        const colorOne: number[] = [];\n        const colorTwo: number[] = []\n\n\n        document.querySelectorAll('.axioms').forEach((element) => {\n            axioms.push((<HTMLInputElement>element).value.toUpperCase());\n        });\n\n        document.querySelectorAll('.rules').forEach((element) => {\n            rules.push((<HTMLInputElement>element).value.toUpperCase());\n        });\n\n        const sentence: string = (<HTMLInputElement>document.querySelector('#sentence')).value.toUpperCase();\n\n        const iterations: number = parseInt((<HTMLInputElement>document.querySelector('#countIterations')).value);\n        const degrees: number = parseInt((<HTMLInputElement>document.querySelector('#degrees')).value);\n        const steplength: number = parseInt((<HTMLInputElement>document.querySelector('#steplength')).value) / 10;\n\n        colorOne.push(parseInt((<HTMLInputElement>document.querySelector('#color-one-r')).value));\n        colorOne.push(parseInt((<HTMLInputElement>document.querySelector('#color-one-g')).value));\n        colorOne.push(parseInt((<HTMLInputElement>document.querySelector('#color-one-b')).value));\n\n        colorTwo.push(parseInt((<HTMLInputElement>document.querySelector('#color-two-r')).value));\n        colorTwo.push(parseInt((<HTMLInputElement>document.querySelector('#color-two-g')).value));\n        colorTwo.push(parseInt((<HTMLInputElement>document.querySelector('#color-two-b')).value));\n\n        const ruleset: Rule[] = [];\n\n        for (let i = 0; i < axioms.length; i++) {\n            ruleset.push(new Rule(axioms[i], rules[i]));\n        }\n\n        const lsys: LSystem = new LSystem(sentence, ruleset);\n\n        console.time('L System generation');\n        for (let i = 0; i < iterations; i++) lsys.generate();\n\n        console.timeEnd('L System generation');\n\n        const turtle: Turtle = new Turtle(lsys.getSentence(), steplength, Utils.DegreesToRadians(degrees));\n\n        return turtle;\n    }\n\n    private addListenerToOBJDownloadButton(): void {\n        //Download rules presets\n        this.objDownloadButton.addEventListener('click', () => {\n            const exporter = new OBJExporter();\n            const result = exporter.parse(scene);\n\n            const link = document.createElement('a');\n            link.download = 'l_system.obj';\n            const blob = new Blob([result], { type: 'text/plain' });\n            link.href = window.URL.createObjectURL(blob);\n            link.click();\n        });\n    }\n\n    private makeSmall(): void {\n        this.makeSmallButton.addEventListener('click', () => {\n            console.log(\"makesmall\")\n\n            document.querySelector('.interface__wrapper').classList.toggle(\"shrink\");\n        });\n    }\n\n}\n"],
  "mappings": "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",
  "names": []
}
